syntax = "proto3";

package auth;

// This is the Go package name
option go_package = "authpb/";


message Account {
  string id = 1;
  string phone = 2;
}

// Auth service
service AuthService {
    rpc Login (LoginRequest) returns (LoginResponse);
    rpc LoginByPhone (LoginByPhoneRequest) returns (LoginResponse);
    rpc Register (RegisterRequest) returns (RegisterResponse);
    rpc RefreshToken (RefreshTokenRequest) returns (RefreshTokenResponse);
    rpc ValidateToken (ValidateTokenRequest) returns (ValidateTokenResponse);
    rpc CheckPhoneExists (CheckPhoneExistsRequest) returns (CheckPhoneExistsResponse);
    rpc GetAccountsByPhone (GetAccountsByPhoneRequest) returns (GetAccountsByPhoneResponse);
    rpc DeleteAccount (DeleteAccountRequest) returns (DeleteAccountResponse);
    rpc GetMyAccount (GetMyAccountRequest) returns (GetMyAccountResponse);
    rpc LoginAdmin (LoginAdminRequest) returns (LoginAdminResponse);
    rpc GetAdminInfo (GetAdminInfoRequest) returns (GetAdminInfoResponse);
    rpc ChangeAdminPassword (ChangeAdminPasswordRequest) returns (ChangeAdminPasswordResponse);
}

// Login request and response
message LoginRequest {
    string phone = 1;
    string password = 2;
}

message LoginResponse {
    string access_token = 1;
    string ws_token = 2;
    string refresh_token = 3;
    int32 expires_in = 4;
}

// Login by Phone request
message LoginByPhoneRequest {
    string phone = 1;
}

// Register request and response
message RegisterRequest {
    string phone = 1;
    string password = 2;
}

message RegisterResponse {
    string access_token = 1;
    string ws_token = 2;
    string refresh_token = 3;
    int32 expires_in = 4;
}

// Refresh token request and response
message RefreshTokenRequest {
    string refresh_token = 1;
}

message RefreshTokenResponse {
    string access_token = 1;
    string ws_token = 2;
    int32 expires_in = 3;
}

// Validate token request and response
message ValidateTokenRequest {
    string access_token = 1;
}

message ValidateTokenResponse {
    bool is_valid = 1;
    string user_id = 2;
}

// Check phone exists request and response
message CheckPhoneExistsRequest {
    string phone = 1;
}

message CheckPhoneExistsResponse {
    bool exists = 1;
}

// Get user by phone numbers request and response
message GetAccountsByPhoneRequest {
    repeated string phone_numbers = 1;
}

message GetAccountsByPhoneResponse {
    repeated Account accounts = 1;
}

// Delete account request and response
message DeleteAccountRequest {
    string account_id = 1;
}

message DeleteAccountResponse {
    bool success = 1;
}

// Get my account request and response
message GetMyAccountRequest {
    string account_id = 1;
}

message GetMyAccountResponse {
    string id = 1;
    string phone = 2;
}

// Admin login request and response
message LoginAdminRequest {
    string username = 1;
    string password = 2;
}

message LoginAdminResponse {
    string access_token = 1;
    string ws_token = 2;
    string refresh_token = 3;
    int32 expires_in = 4;
    string role = 5;
}

// Get admin info request and response
message GetAdminInfoRequest {
    string admin_id = 1;
}

message GetAdminInfoResponse {
    string id = 1;
    string username = 2;
    string role = 3;
    bool is_active = 4;
}

// Change admin password request and response
message ChangeAdminPasswordRequest {
    string admin_id = 1;
    string old_password = 2;
    string new_password = 3;
}

message ChangeAdminPasswordResponse {
    bool success = 1;
    string message = 2;
}